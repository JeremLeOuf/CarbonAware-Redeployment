2025-03-16 15:00:29 - INFO - Cleared test results log file!

2025-03-16 15:00:29 - INFO - ==================================================
2025-03-16 15:00:29 - INFO - Starting pre-tests checks...
2025-03-16 15:00:31 - INFO - ==================================================
2025-03-16 15:00:31 - INFO - TEST SCENARIO: Dependency Check
2025-03-16 15:00:31 - INFO - aws available ✅
2025-03-16 15:00:31 - INFO - terraform available ✅
2025-03-16 15:00:31 - INFO - python available ✅
2025-03-16 15:00:31 - INFO - Result: PASSED ✅
2025-03-16 15:00:31 - INFO - Details: All dependencies are installed.
2025-03-16 15:00:37 - INFO - ==================================================
2025-03-16 15:00:37 - INFO - TEST SCENARIO: AWS Configuration
2025-03-16 15:00:37 - INFO - AWS configured as: arn:aws:iam::448049797169:user/HTW
2025-03-16 15:00:37 - INFO - AWS EC2 permissions verified.
2025-03-16 15:00:37 - INFO - AWS Route53 permissions verified.
2025-03-16 15:00:37 - INFO - Result: PASSED ✅
2025-03-16 15:00:37 - INFO - Details: AWS is properly configured.
2025-03-16 15:00:42 - INFO - ==================================================
2025-03-16 15:00:42 - INFO - TEST SCENARIO: AWS Regions
2025-03-16 15:00:42 - INFO - Checking AWS regions...
2025-03-16 15:00:42 - INFO - Region eu-west-1 is accessible.
2025-03-16 15:00:42 - INFO - Region eu-west-2 is accessible.
2025-03-16 15:00:42 - INFO - Region eu-central-1 is accessible.
2025-03-16 15:00:42 - INFO - Result: PASSED ✅
2025-03-16 15:00:42 - INFO - Details: All AWS regions accessible.
2025-03-16 15:00:44 - INFO - ==================================================
2025-03-16 15:00:44 - INFO - TEST SCENARIO: DNS Configuration
2025-03-16 15:00:44 - INFO - Checking DNS configuration...
2025-03-16 15:00:44 - INFO - Found hosted zone: jeremapp.click.
2025-03-16 15:00:44 - INFO - Result: PASSED ✅
2025-03-16 15:00:44 - INFO - Details: DNS configuration is correct.
2025-03-16 15:00:45 - INFO - ==================================================
2025-03-16 15:00:45 - INFO - TEST SCENARIO: ElectricityMaps API
2025-03-16 15:00:45 - INFO - Checking Electricity Maps API...
2025-03-16 15:00:45 - INFO - API working for zone IE; carbon intensity: 535
2025-03-16 15:00:45 - INFO - Result: PASSED ✅
2025-03-16 15:00:45 - INFO - Details: Electricity Maps API is accessible.
2025-03-16 15:00:45 - INFO - ==================================================
2025-03-16 15:00:45 - INFO - TEST SCENARIO: Environment Variables
2025-03-16 15:00:45 - INFO - Environment variable set: ELECTRICITYMAPS_API_TOKEN
2025-03-16 15:00:45 - INFO - Environment variable set: HOSTED_ZONE_ID
2025-03-16 15:00:45 - INFO - Environment variable set: DOMAIN_NAME
2025-03-16 15:00:45 - INFO - Result: PASSED ✅
2025-03-16 15:00:45 - INFO - Details: All required variables set.
2025-03-16 15:00:50 - INFO - ==================================================
2025-03-16 15:00:50 - INFO - TEST SCENARIO: Terraform Files
2025-03-16 15:00:50 - INFO - Terraform file exists: main.tf
2025-03-16 15:00:50 - INFO - Terraform file exists: variables.tf
2025-03-16 15:00:50 - INFO - Terraform file exists: outputs.tf
2025-03-16 15:00:50 - INFO - Terraform file exists: terraform.tfvars
2025-03-16 15:00:50 - INFO - Terraform configuration is valid.
2025-03-16 15:00:50 - INFO - Result: PASSED ✅
2025-03-16 15:00:50 - INFO - Details: Files exist and configuration is valid.
2025-03-16 15:01:00 - INFO - ==================================================
2025-03-16 15:01:00 - INFO - TEST SCENARIO: Resource Limits
2025-03-16 15:01:00 - INFO - EC2 instance limit in eu-west-1: 20
2025-03-16 15:01:00 - INFO - Security groups in eu-west-1: 1
2025-03-16 15:01:00 - INFO - EC2 instance limit in eu-west-2: 20
2025-03-16 15:01:00 - INFO - Security groups in eu-west-2: 2
2025-03-16 15:01:00 - INFO - EC2 instance limit in eu-central-1: 20
2025-03-16 15:01:00 - INFO - Security groups in eu-central-1: 1
2025-03-16 15:01:00 - INFO - Result: PASSED ✅
2025-03-16 15:01:00 - INFO - Details: Sufficient resources available.
2025-03-16 15:01:00 - INFO - ==================================================
2025-03-16 15:01:00 - INFO - TEST SCENARIO: AWS Cost Estimate
2025-03-16 15:01:00 - INFO - AWS cost estimate: $0.10/hour for t2.micro instances
2025-03-16 15:01:00 - INFO - No AWS budget alerts configured (recommended for production)
2025-03-16 15:01:00 - INFO - Result: PASSED ✅
2025-03-16 15:01:00 - INFO - Details: Cost estimates are acceptable.
2025-03-16 15:01:00 - INFO - ==================================================
2025-03-16 15:01:00 - INFO - TEST SCENARIO: Terraform State
2025-03-16 15:01:00 - INFO - Terraform state file exists: terraform.tfstate
2025-03-16 15:01:00 - INFO - Terraform state file exists: terraform.tfstate.backup
2025-03-16 15:01:00 - INFO - Result: PASSED ✅
2025-03-16 15:01:00 - INFO - Details: Terraform state is properly managed.
2025-03-16 15:01:03 - INFO - ==================================================
2025-03-16 15:01:03 - INFO - TEST SCENARIO: Security Configuration
2025-03-16 15:01:03 - INFO - Security group settings check passed.
2025-03-16 15:01:03 - INFO - S3 bucket configuration check passed.
2025-03-16 15:01:03 - INFO - Result: PASSED ✅
2025-03-16 15:01:03 - INFO - Details: Security configurations appear proper.
2025-03-16 15:01:03 - INFO - ==================================================
2025-03-16 15:01:03 - INFO - Pre-tests all passed! Now proceeding to actual tests...
2025-03-16 15:01:59 - INFO - ==================================================
2025-03-16 15:01:59 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:01:59 - INFO - Cleaning up all resources...
2025-03-16 15:01:59 - INFO - Cleaned up Terraform state successfully.
2025-03-16 15:01:59 - INFO - ==================================================
2025-03-16 15:01:59 - INFO - TEST SCENARIO: ElectricityMaps API
2025-03-16 15:01:59 - INFO - Checking Electricity Maps API...
2025-03-16 15:01:59 - INFO - API working for zone IE; carbon intensity: 535
2025-03-16 15:01:59 - INFO - Result: PASSED ✅
2025-03-16 15:01:59 - INFO - Details: Electricity Maps API is accessible.
2025-03-16 15:02:01 - INFO - ==================================================
2025-03-16 15:02:01 - INFO - TEST SCENARIO: Error Scenarios
2025-03-16 15:02:01 - INFO - Testing invalid region, invalid instance ID, invalid security group...
2025-03-16 15:02:01 - INFO - Invalid Region => Correctly failed with region 'invalid-region'.
2025-03-16 15:02:01 - INFO - Invalid Instance ID => Correctly failed with instance ID 'i-invalid'.
2025-03-16 15:02:01 - INFO - Invalid Security Group => Correctly failed with security group 'invalid-SG'.
2025-03-16 15:02:01 - INFO - Result: PASSED ✅
2025-03-16 15:02:01 - INFO - Details: All error scenarios worked as expected.
2025-03-16 15:02:22 - INFO - ==================================================
2025-03-16 15:02:22 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:02:22 - INFO - Cleaning up all resources...
2025-03-16 15:02:22 - INFO - Cleaned up Terraform state successfully.
2025-03-16 15:04:39 - INFO - ==================================================
2025-03-16 15:04:39 - INFO - TEST SCENARIO: Scenario 1 - No instances
2025-03-16 15:04:39 - INFO - Cleaning up all resources first...
2025-03-16 15:04:39 - INFO - Running deploy with no instances expected.
2025-03-16 15:04:39 - INFO - FOUND PATTERN: No old instances found to clean up
2025-03-16 15:04:39 - INFO - Result: PASSED ✅
2025-03-16 15:04:39 - INFO - Details: No instances scenario worked.
2025-03-16 15:05:55 - INFO - ==================================================
2025-03-16 15:05:55 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:05:55 - INFO - Cleaning up all resources...
2025-03-16 15:05:55 - INFO - Cleaned up Terraform state successfully.
2025-03-16 15:09:52 - INFO - ==================================================
2025-03-16 15:09:52 - INFO - TEST SCENARIO: Scenario 2 - High carbon region
2025-03-16 15:09:52 - INFO - Cleaning up all resources first...
2025-03-16 15:09:52 - INFO - Running terraform in eu-central-1 (high carbon region).
2025-03-16 15:09:52 - INFO - Capturing output from main deploy function...
2025-03-16 15:09:52 - INFO - FOUND PATTERN: Found running instance(s) in 'eu-central-1'
2025-03-16 15:09:52 - INFO - FOUND PATTERN: Lower carbon region detected
2025-03-16 15:09:52 - INFO - FOUND PATTERN: Cleanup complete
2025-03-16 15:09:52 - INFO - Result: PASSED ✅
2025-03-16 15:09:52 - INFO - Details: All expected patterns found.
2025-03-16 15:10:51 - INFO - ==================================================
2025-03-16 15:10:51 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:10:51 - INFO - Cleaning up all resources...
2025-03-16 15:10:51 - INFO - Cleaned up Terraform state successfully.
2025-03-16 15:11:22 - INFO - ==================================================
2025-03-16 15:11:22 - INFO - TEST SCENARIO: Scenario 3 - Greenest region
2025-03-16 15:11:22 - INFO - Cleaning up all resources first...
2025-03-16 15:11:22 - INFO - Deploying to eu-west-2 (greenest region).
2025-03-16 15:11:22 - INFO - Capturing output from main deploy function...
2025-03-16 15:11:22 - INFO - FOUND PATTERN: Found running instance(s) in 'eu-west-2'
2025-03-16 15:11:22 - INFO - FOUND PATTERN: Already in the lowest carbon region available: 'eu-west-2'
2025-03-16 15:11:22 - INFO - FOUND PATTERN: No need to redeploy
2025-03-16 15:11:22 - INFO - Result: PASSED ✅
2025-03-16 15:11:22 - INFO - Details: All expected patterns found.
2025-03-16 15:11:25 - INFO - ==================================================
2025-03-16 15:11:25 - INFO - TEST SCENARIO: Scenario 4 - Missing API Token
2025-03-16 15:11:25 - INFO - Removing the ElectricityMaps API token to force a failure.
2025-03-16 15:11:25 - INFO - API responded with 404, as expected (non-200).
2025-03-16 15:11:25 - INFO - Result: PASSED ✅
2025-03-16 15:11:25 - INFO - Details: Properly failed without an API token.
2025-03-16 15:12:54 - INFO - ==================================================
2025-03-16 15:12:54 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:12:54 - INFO - Cleaning up all resources...
2025-03-16 15:12:54 - INFO - Cleaned up Terraform state successfully.
2025-03-16 15:17:36 - INFO - ==================================================
2025-03-16 15:17:36 - INFO - TEST SCENARIO: Scenario 5 - Multiple instances
2025-03-16 15:17:36 - INFO - Cleaning up all resources first...
2025-03-16 15:17:36 - INFO - Deploying instance to eu-west-1.
2025-03-16 15:17:36 - INFO - Deploying instance to eu-central-1.
2025-03-16 15:17:36 - INFO - Capturing output from main deploy function (multiple instances).
2025-03-16 15:17:36 - INFO - FOUND PATTERN: Found running instance(s)
2025-03-16 15:17:36 - INFO - FOUND PATTERN: Starting redeployment process
2025-03-16 15:17:36 - INFO - FOUND PATTERN: Cleanup complete
2025-03-16 15:17:36 - INFO - Result: PASSED ✅
2025-03-16 15:17:36 - INFO - Details: All expected patterns found.
2025-03-16 15:19:02 - INFO - ==================================================
2025-03-16 15:19:02 - INFO - CLEANUP: Cleaning resources before proceeding...
2025-03-16 15:19:02 - INFO - Cleaning up all resources...
2025-03-16 15:19:02 - INFO - Cleaned up Terraform state successfully.
